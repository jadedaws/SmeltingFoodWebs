---
title: "Prey Fish Size Selection"
author: "J Dawson"
date: '2020-06-17'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r import data}
library(tidyverse)
library(readr)

data <- read_csv("data/studylakes_catchdata.csv")
data <- data[c(-20,-21,-22)]

```

##Want to find the distribution of size for each prey fish species for each lake to determine isotope sample gradient, so we only keep fish with FLEN <=200mm.

```{r subset data for prey fish only}

preyfish <- subset(data, data$FLEN<200)

```

```{r subset data for Baby Lk. prey fish}

babyprey <- subset(preyfish, preyfish$FK_Survey_ID == "11")

##Subset by species w/ more than 10 samples - aka where we have to select on the gradient
#Common Shiner
baby_comshin <- subset(babyprey, babyprey$`Species code` == "198")
baby_comshin_freq<- plyr::count(baby_comshin, "FLEN")
# Counts the number of observations according to FLEN
baby_comshin_freq$freqlbls <- as.character(baby_comshin_freq$freq)
# Calculating percent in each size class
baby_comshin_freq$pct <- round(baby_comshin_freq$freq/sum(baby_comshin_freq$freq)*100)
baby_comshin_freq$pctlbls <- as.character(baby_comshin_freq$pct)
# Adding % to the labels
baby_comshin_freq$pctlbls <- paste(baby_comshin_freq$pctlbls,"%",sep="")

#Pumpkinseed
baby_pseed <- subset(babyprey, babyprey$`Species code` == "313")
baby_pseed_freq<- plyr::count(baby_pseed, "FLEN")
baby_pseed_freq$freqlbls <- as.character(baby_pseed_freq$freq)
baby_pseed_freq$pct <- round(baby_pseed_freq$freq/sum(baby_pseed_freq$freq)*100)
baby_pseed_freq$pctlbls <- as.character(baby_pseed_freq$pct)
baby_pseed_freq$pctlbls <- paste(baby_pseed_freq$pctlbls,"%",sep="")

#Yellow Perch
baby_perch <- subset(babyprey, babyprey$`Species code` == "331")
baby_perch_freq<- plyr::count(baby_perch, "FLEN")
baby_perch_freq$freqlbls <- as.character(baby_perch_freq$freq)
baby_perch_freq$pct <- round(baby_perch_freq$freq/sum(baby_perch_freq$freq)*100)
baby_perch_freq$pctlbls <- as.character(baby_perch_freq$pct)
baby_perch_freq$pctlbls <- paste(baby_perch_freq$pctlbls,"%",sep="")

```

```{r Baby Lk. common shiner prey fish size distributions}
##Size histogram
ggplot(data = baby_comshin, aes(FLEN)) + 
  geom_histogram(breaks=seq(60, 130, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Baby Lake Common Shiner Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=baby_comshin_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Baby Lake Common Shiner Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Baby Lake catch data to proportionately select samples for isotope analysis we need common shiners with the following fork lengths: 1 - 70mm, 3 - 80mm, 5 - 90mm, and 1 - 100mm.

```{r Baby Lk. pumpkinseed prey fish size distributions}
##Size histogram
ggplot(data = baby_pseed, aes(FLEN)) + 
  geom_histogram(breaks=seq(60, 120, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Baby Lake Pumpkinseed Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=baby_pseed_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Baby Lake Pumpkinseed Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Baby Lake catch data to proportionately select samples for isotope analysis we need pumpkinseeds with the following fork lengths: 1 - 70mm, 3 - 80mm, 3 - 90mm, 2 - 100mm, and 1 - 110mm.

```{r Baby Lk. yellow perch prey fish size distributions}
##Size histogram
ggplot(data = baby_perch, aes(FLEN)) + 
  geom_histogram(breaks=seq(50, 210, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Baby Lake Yellow Perch Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=baby_perch_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Baby Lake Yellow Perch Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Baby Lake catch data to proportionately select samples for isotope analysis we need yellow perch with the following fork lengths: 1 - 70mm, 3 - 80mm, 3 - 90mm, 1 - 100mm, 1 - 110mm, and 1 - 120mm.

```{r subset data for Daisy Lk. prey fish}

daisyprey <- subset(preyfish, preyfish$FK_Survey_ID == "14")

##Subset by species w/ more than 10 samples - aka where we have to select on the gradient
# Brown Bullhead
daisy_bbull <- subset(daisyprey, daisyprey$`Species code` == "233")
daisy_bbull_freq<- plyr::count(daisy_bbull, "FLEN")
daisy_bbull_freq$freqlbls <- as.character(daisy_bbull_freq$freq)
daisy_bbull_freq$pct <- round(daisy_bbull_freq$freq/sum(daisy_bbull_freq$freq)*100)
daisy_bbull_freq$pctlbls <- as.character(daisy_bbull_freq$pct)
daisy_bbull_freq$pctlbls <- paste(daisy_bbull_freq$pctlbls,"%",sep="")

# Smallmouth Bass
daisy_smb <- subset(daisyprey, daisyprey$`Species code` == "316")
daisy_smb_freq<- plyr::count(daisy_smb, "FLEN")
daisy_smb_freq$freqlbls <- as.character(daisy_smb_freq$freq)
daisy_smb_freq$pct <- round(daisy_smb_freq$freq/sum(daisy_smb_freq$freq)*100)
daisy_smb_freq$pctlbls <- as.character(daisy_smb_freq$pct)
daisy_smb_freq$pctlbls <- paste(daisy_smb_freq$pctlbls,"%",sep="")

# Yellow Perch
daisy_perch <- subset(daisyprey, daisyprey$`Species code` == "331")
daisy_perch_freq<- plyr::count(baby_perch, "FLEN")
daisy_perch_freq$freqlbls <- as.character(daisy_perch_freq$freq)
daisy_perch_freq$pct <- round(daisy_perch_freq$freq/sum(daisy_perch_freq$freq)*100)
daisy_perch_freq$pctlbls <- as.character(daisy_perch_freq$pct)
daisy_perch_freq$pctlbls <- paste(daisy_perch_freq$pctlbls,"%",sep="")

```

```{r Daisy Lk. brown bullhead prey fish size distributions}
##Size histogram
ggplot(data = daisy_bbull, aes(FLEN)) + 
  geom_histogram(breaks=seq(80, 210, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Daisy Lake Brown Bullhead Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=daisy_bbull_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Daisy Lake Brown Bullhead Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Daisy Lake catch data to proportionately select samples for isotope analysis we need brown bullheads with the following fork lengths: 1 - 90mm, 1 - 130mm, 1 - 150mm, 2 - 170mm, 3 - 180mm, and 2 - 190mm.

```{r Daisy Lk. smallmouth bass prey fish size distributions}
##Size histogram
ggplot(data = daisy_smb, aes(FLEN)) + 
  geom_histogram(breaks=seq(100, 210, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Daisy Lake Smallmouth Bass Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=daisy_smb_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Daisy Lake Smallmouth Bass Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Daisy Lake catch data to proportionately select samples for isotope analysis we need smallmouth bass with the following fork lengths: 1 - 110mm, 1 - 120mm, 2 - 130mm, 2 - 140mm, 2 - 150mm, 1 - 160mm, 1 - 190mm.

```{r Daisy Lk. yellow perch prey fish size distributions}
##Size histogram
ggplot(data = daisy_perch, aes(FLEN)) + 
  geom_histogram(breaks=seq(30, 180, by = 10), 
                 col="black", 
                 fill="grey", 
                 alpha = .7) + 
  labs(title="Daisy Lake Yellow Perch Size", x="Fork Length (mm)", y="Count")

##Size histogram w/ percent labels
ggplot(data=daisy_perch_freq, aes(x=FLEN, y=freq))+
  geom_bar(stat="identity",width=8, colour = "black")+
  xlab("Fork Length (mm)")+
  ylab("Frequency")+
  ggtitle("Daisy Lake Yellow Perch Size Distribution")+
  scale_y_continuous()+
  scale_x_continuous()+
  geom_text(aes(label=pctlbls), vjust=-0.5)+
  theme_bw()

```

#Based on the Daisy Lake catch data to proportionately select samples for isotope analysis we need yellow perch with the following fork lengths: 1 - 70mm, 3 - 80mm, 3 - 90mm, 1 - 100mm, 1 - 110mm, and 1 - 120mm.
